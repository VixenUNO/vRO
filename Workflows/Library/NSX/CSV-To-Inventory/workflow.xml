<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns2:workflow xmlns:ns2="http://vmware.com/vco/workflow" root-name="item1" object-name="workflow:name=generic" id="9111aa7f-da5f-4c23-b3ed-831f58a272fa" editor-version="2.0" version="0.0.0" api-version="6.0.0" restartMode="1" resumeFromFailedMode="0">
    <display-name>CSV-To-Inventory</display-name>
    <position y="-3.0" x="121.1764705882353"/>
    <input>
        <param name="CSV" type="MimeAttachment"/>
    </input>
    <output>
        <param name="actionResult" type="string"/>
    </output>
    <attrib name="parsedjson" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="arrayfromjson" type="Array/Properties">
        <value encoded="n">[]</value>
    </attrib>
    <attrib name="currentelementnumber" type="number">
        <value encoded="n">0.0</value>
    </attrib>
    <attrib name="totalnumberofelements" type="number">
        <value encoded="n"/>
    </attrib>
    <attrib name="inventorytype" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="AllServices" type="Array/string">
        <value encoded="n"/>
    </attrib>
    <attrib name="restHost" type="REST:RESTHost">
        <value encoded="n">dunes://service.dunes.ch/CustomSDKObject?id='5f1cdc0b-51c7-4bf8-972a-608584e7beb6'&amp;dunesName='REST:RESTHost'</value>
    </attrib>
    <attrib name="AllGroups" type="Array/string">
        <value encoded="n"/>
    </attrib>
    <attrib name="Type" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="Name_Parent_group" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="Value_Child_element" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="Description" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="revision" type="string">
        <value encoded="n"></value>
        <description></description>
    </attrib>
    <workflow-item name="item1" out-name="item6" type="task" script-module="uno.vixen.nsx.inventory/ParseCSVTemplateToJSON" comparator="0">
        <display-name>ParseCSVTemplateToJSON</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("uno.vixen.nsx.inventory").ParseCSVTemplateToJSON(CSV);
</script>
        <in-binding>
            <bind name="CSV" type="MimeAttachment" export-name="CSV">
                <description></description>
            </bind>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="Array/Properties" export-name="arrayfromjson"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="48.82352941176471" x="10.588235294117652"/>
    </workflow-item>
    <workflow-item name="item2" type="switch" comparator="0">
        <display-name>Switch</display-name>
        <script encoded="false">// Generated by the system, cannot be edited
if (inventorytype === "Host") {
  return "item10";
} else if (inventorytype === "Group") {
  return "item11";
} else if (inventorytype === "Service") {
  return "item12";
} else if (inventorytype === "ServiceGroup") {
  return "item13";
} else if (inventorytype === "SubGroup") {
  return "item14";
} else if (true) {
  return "item9";
}
</script>
        <in-binding>
            <bind name="inventorytype" type="string" export-name="inventorytype"/>
        </in-binding>
        <out-binding/>
        <description>Basic switch activity based on a workflow attribute or parameter.</description>
        <condition name="inventorytype" type="string" comparator="0" label="item10">Host</condition>
        <condition name="inventorytype" type="string" comparator="0" label="item11">Group</condition>
        <condition name="inventorytype" type="string" comparator="0" label="item12">Service</condition>
        <condition name="inventorytype" type="string" comparator="0" label="item13">ServiceGroup</condition>
        <condition name="inventorytype" type="string" comparator="0" label="item14">SubGroup</condition>
        <condition name="" type="boolean" comparator="6" label="item9"></condition>
        <position y="271.1764705882353" x="222.3529411764706"/>
    </workflow-item>
    <workflow-item name="item4" type="end" end-mode="0" comparator="0">
        <in-binding/>
        <out-binding/>
        <position y="3.529411764705884" x="309.4117647058824"/>
    </workflow-item>
    <workflow-item name="item5" out-name="item7" alt-out-name="item4" type="custom-condition" comparator="0">
        <display-name>Cycle Start or Finish</display-name>
        <script encoded="false">if(currentelementnumber &lt;= totalnumberofelements-1){
    return true;
}else{
    return false;
}</script>
        <in-binding>
            <bind name="currentelementnumber" type="number" export-name="currentelementnumber"/>
            <bind name="totalnumberofelements" type="number" export-name="totalnumberofelements"/>
        </in-binding>
        <out-binding/>
        <description>Custom decision based on a custom script.</description>
        <position y="38.82352941176471" x="175.29411764705884"/>
    </workflow-item>
    <workflow-item name="item6" out-name="item15" type="task" comparator="0">
        <display-name>Get Total Number of Elements</display-name>
        <script encoded="false">totalnumberofelements = arrayfromjson.length;</script>
        <in-binding>
            <bind name="arrayfromjson" type="Array/Properties" export-name="arrayfromjson"/>
        </in-binding>
        <out-binding>
            <bind name="totalnumberofelements" type="number" export-name="totalnumberofelements"/>
        </out-binding>
        <description>Simple task with custom script capability.</description>
        <position y="107.64705882352942" x="10.588235294117652"/>
    </workflow-item>
    <workflow-item name="item7" out-name="item2" type="task" comparator="0">
        <display-name>Parse Inventory Array String</display-name>
        <script encoded="false">inventorytype = arrayfromjson[currentelementnumber].Type;

type = arrayfromjson[currentelementnumber].Type;
Name_Parent_group = arrayfromjson[currentelementnumber].Name_Parent_group;
Value_Child_element = arrayfromjson[currentelementnumber].Value_Child_element;
Description = arrayfromjson[currentelementnumber].Description;</script>
        <in-binding>
            <bind name="arrayfromjson" type="Array/Properties" export-name="arrayfromjson"/>
            <bind name="currentelementnumber" type="number" export-name="currentelementnumber"/>
        </in-binding>
        <out-binding>
            <bind name="inventorytype" type="string" export-name="inventorytype"/>
            <bind name="type" type="string" export-name="Type"/>
            <bind name="Name_Parent_group" type="string" export-name="Name_Parent_group"/>
            <bind name="Value_Child_element" type="string" export-name="Value_Child_element"/>
            <bind name="Description" type="string" export-name="Description"/>
        </out-binding>
        <description>Simple task with custom script capability.</description>
        <position y="166.47058823529412" x="198.8235294117647"/>
    </workflow-item>
    <workflow-item name="item8" out-name="item5" type="task" comparator="0">
        <display-name>Next Element</display-name>
        <script encoded="false">currentelementnumber = currentelementnumber + 1;
</script>
        <in-binding>
            <bind name="currentelementnumber" type="number" export-name="currentelementnumber"/>
        </in-binding>
        <out-binding>
            <bind name="currentelementnumber" type="number" export-name="currentelementnumber"/>
        </out-binding>
        <description>Simple task with custom script capability.</description>
        <position y="37.05882352941177" x="1445.8823529411766"/>
    </workflow-item>
    <workflow-item name="item9" type="end" end-mode="0" comparator="0">
        <in-binding/>
        <out-binding/>
        <position y="321.1764705882353" x="262.3529411764706"/>
    </workflow-item>
    <workflow-item name="item10" out-name="item18" type="task" comparator="0">
        <display-name>HOST</display-name>
        <script encoded="false"></script>
        <in-binding/>
        <out-binding/>
        <description>Simple task with custom script capability.</description>
        <position y="107.64705882352942" x="363.5294117647059"/>
    </workflow-item>
    <workflow-item name="item11" out-name="item8" type="task" comparator="0">
        <display-name>GROUP</display-name>
        <script encoded="false"></script>
        <in-binding/>
        <out-binding/>
        <description>Simple task with custom script capability.</description>
        <position y="331.1764705882353" x="363.5294117647059"/>
    </workflow-item>
    <workflow-item name="item12" out-name="item8" type="task" comparator="0">
        <display-name>SERVICE</display-name>
        <script encoded="false"></script>
        <in-binding/>
        <out-binding/>
        <description>Simple task with custom script capability.</description>
        <position y="166.4705882352941" x="363.5294117647059"/>
    </workflow-item>
    <workflow-item name="item13" out-name="item8" type="task" comparator="0">
        <display-name>SERVICE GROUP</display-name>
        <script encoded="false"></script>
        <in-binding/>
        <out-binding/>
        <description>Simple task with custom script capability.</description>
        <position y="225.29411764705884" x="363.5294117647059"/>
    </workflow-item>
    <workflow-item name="item14" out-name="item8" type="task" comparator="0">
        <display-name>SUB GROUP</display-name>
        <script encoded="false"></script>
        <in-binding/>
        <out-binding/>
        <description>Simple task with custom script capability.</description>
        <position y="378.23529411764713" x="363.5294117647059"/>
    </workflow-item>
    <workflow-item name="item15" out-name="item16" type="task" script-module="uno.vixen.nsx.inventory/GetAllServices" comparator="0">
        <display-name>GetAllServices</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("uno.vixen.nsx.inventory").GetAllServices(restHost);
</script>
        <in-binding>
            <bind name="restHost" type="REST:RESTHost" export-name="restHost">
                <description></description>
            </bind>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="Array/string" export-name="AllServices"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="166.47058823529412" x="10.588235294117652"/>
    </workflow-item>
    <workflow-item name="item16" out-name="item5" type="task" script-module="uno.vixen.nsx.inventory/GetAllGroups" comparator="0">
        <display-name>GetAllGroups</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("uno.vixen.nsx.inventory").GetAllGroups(restHost);
</script>
        <in-binding>
            <bind name="restHost" type="REST:RESTHost" export-name="restHost">
                <description></description>
            </bind>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="Array/string" export-name="AllGroups"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="217.00982498759805" x="10.279844249051251"/>
    </workflow-item>
    <workflow-item name="item18" out-name="item8" alt-out-name="item19" type="custom-condition" comparator="0">
        <display-name>Check if host group exist</display-name>
        <script encoded="false">for (i = 0; i &lt; AllGroups.length - 1; i++) {
    System.log(arrayfromjson[currentelementnumber].Name_Parent_group + " ? " + AllGroups[i]);

    if (arrayfromjson[currentelementnumber].Name_Parent_group == AllGroups[i]) {
        return true;
        System.log(arrayfromjson[currentelementnumber].Name_Parent_group + " ? " + AllGroups[i]);
    }
}
return false;</script>
        <in-binding>
            <bind name="AllGroups" type="Array/string" export-name="AllGroups"/>
            <bind name="currentelementnumber" type="number" export-name="currentelementnumber"/>
            <bind name="arrayfromjson" type="Array/Properties" export-name="arrayfromjson"/>
        </in-binding>
        <out-binding/>
        <description>Custom decision based on a custom script.</description>
        <position y="97.64705882352942" x="481.17647058823536"/>
    </workflow-item>
    <workflow-item name="item19" out-name="item8" type="task" script-module="uno.vixen.nsx/CreateInventoryHostGroup" comparator="0">
        <display-name>CreateInventoryHostGroup</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("uno.vixen.nsx").CreateInventoryHostGroup(restHost,groupname,ip,description);
</script>
        <in-binding>
            <bind name="restHost" type="REST:RESTHost" export-name="restHost">
                <description></description>
            </bind>
            <bind name="groupname" type="string" export-name="Name_Parent_group">
                <description></description>
            </bind>
            <bind name="ip" type="string" export-name="Value_Child_element">
                <description></description>
            </bind>
            <bind name="description" type="string" export-name="Description">
                <description></description>
            </bind>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="string" export-name=""/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="72.35294117647058" x="622.3529411764706"/>
    </workflow-item>
</ns2:workflow>
